<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portail Partenaires - Centum T&S</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f5f7fa; min-height: 100vh; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState } = React;
        
        // Donn√©es avec p√©riodes r√©alistes f√©vrier-d√©cembre 2026
        // Cong√©s typiques France : vacances de f√©vrier (zone), P√¢ques (avril), ponts de mai, √©t√© (juillet-ao√ªt), Toussaint, No√´l
        const consultantsData = [
            { 
                id: 1, code: "FLEGA", 
                competences: ["Archi. √©lectronique", "Safety", "Ing. Syst√®me"], 
                secteurs: ["A√©ronautique", "D√©fense", "A√©rospatial"], 
                seniorite: "Senior", experience: 8, tjmBase: 650,
                periodes: [
                    { debut: "2026-02-10", fin: "2026-04-10", type: "dispo" },
                    { debut: "2026-04-11", fin: "2026-04-26", type: "indispo" }, // Vacances P√¢ques
                    { debut: "2026-04-27", fin: "2026-07-17", type: "dispo" },
                    { debut: "2026-07-18", fin: "2026-08-16", type: "indispo" }, // Cong√©s √©t√©
                    { debut: "2026-08-17", fin: "2026-10-23", type: "dispo" },
                    { debut: "2026-10-24", fin: "2026-11-01", type: "indispo" }, // Toussaint
                    { debut: "2026-11-02", fin: "2026-12-18", type: "dispo" },
                    { debut: "2026-12-19", fin: "2026-12-31", type: "indispo" } // No√´l
                ]
            },
            { 
                id: 2, code: "MDUPO", 
                competences: ["Concepteur HW", "Test & Mesure", "Validation"], 
                secteurs: ["Automobile", "A√©ronautique"], 
                seniorite: "Confirm√©", experience: 5, tjmBase: 550,
                periodes: [
                    { debut: "2026-02-01", fin: "2026-02-15", type: "indispo" }, // Fin mission + vacances f√©vrier
                    { debut: "2026-02-16", fin: "2026-05-07", type: "dispo" },
                    { debut: "2026-05-08", fin: "2026-05-17", type: "indispo" }, // Pont mai (8 mai + Ascension)
                    { debut: "2026-05-18", fin: "2026-07-31", type: "dispo" },
                    { debut: "2026-08-01", fin: "2026-08-23", type: "indispo" }, // Cong√©s √©t√©
                    { debut: "2026-08-24", fin: "2026-12-20", type: "dispo" },
                    { debut: "2026-12-21", fin: "2026-12-31", type: "indispo" } // No√´l
                ]
            },
            { 
                id: 3, code: "PMART", 
                competences: ["Ing. Syst√®me", "MBSE", "Requirements"], 
                secteurs: ["A√©rospatial"], 
                seniorite: "Junior", experience: 2, tjmBase: 420,
                periodes: [
                    { debut: "2026-02-01", fin: "2026-03-31", type: "indispo" }, // Mission en cours
                    { debut: "2026-04-01", fin: "2026-07-10", type: "dispo" },
                    { debut: "2026-07-11", fin: "2026-08-02", type: "indispo" }, // Cong√©s √©t√© (3 semaines junior)
                    { debut: "2026-08-03", fin: "2026-12-18", type: "dispo" },
                    { debut: "2026-12-19", fin: "2026-12-31", type: "indispo" } // No√´l
                ]
            },
            { 
                id: 4, code: "SBERN", 
                competences: ["Archi. √©lectronique", "EMC", "Certification"], 
                secteurs: ["D√©fense", "A√©ronautique", "A√©rospatial"], 
                seniorite: "Senior", experience: 12, tjmBase: 720,
                periodes: [
                    { debut: "2026-02-10", fin: "2026-02-22", type: "dispo" },
                    { debut: "2026-02-23", fin: "2026-03-08", type: "indispo" }, // Vacances f√©vrier zone C
                    { debut: "2026-03-09", fin: "2026-06-30", type: "dispo" },
                    { debut: "2026-07-01", fin: "2026-07-26", type: "indispo" }, // Cong√©s √©t√© anticip√©s
                    { debut: "2026-07-27", fin: "2026-10-30", type: "dispo" },
                    { debut: "2026-10-31", fin: "2026-11-08", type: "indispo" }, // Toussaint √©tendu
                    { debut: "2026-11-09", fin: "2026-12-23", type: "dispo" },
                    { debut: "2026-12-24", fin: "2026-12-31", type: "indispo" } // No√´l
                ]
            },
            { 
                id: 5, code: "TROUX", 
                competences: ["Test & Mesure", "Banc de test", "LabVIEW"], 
                secteurs: ["Automobile", "A√©ronautique"], 
                seniorite: "Confirm√©", experience: 6, tjmBase: 580,
                periodes: [
                    { debut: "2026-02-25", fin: "2026-04-17", type: "dispo" },
                    { debut: "2026-04-18", fin: "2026-04-26", type: "indispo" }, // P√¢ques
                    { debut: "2026-04-27", fin: "2026-08-07", type: "dispo" },
                    { debut: "2026-08-08", fin: "2026-08-30", type: "indispo" }, // Cong√©s √©t√©
                    { debut: "2026-08-31", fin: "2026-12-31", type: "dispo" }
                ]
            },
            { 
                id: 6, code: "AGARC", 
                competences: ["Software embarqu√©", "C/C++", "AUTOSAR"], 
                secteurs: ["Automobile"], 
                seniorite: "Senior", experience: 10, tjmBase: 680,
                periodes: [
                    { debut: "2026-02-17", fin: "2026-05-21", type: "dispo" },
                    { debut: "2026-05-22", fin: "2026-05-31", type: "indispo" }, // Pont Ascension + week-end
                    { debut: "2026-06-01", fin: "2026-07-24", type: "dispo" },
                    { debut: "2026-07-25", fin: "2026-08-23", type: "indispo" }, // Cong√©s √©t√©
                    { debut: "2026-08-24", fin: "2026-12-18", type: "dispo" },
                    { debut: "2026-12-19", fin: "2026-12-31", type: "indispo" } // No√´l
                ]
            },
            { 
                id: 7, code: "LMONN", 
                competences: ["Certification DO-178", "Safety", "ARP4754"], 
                secteurs: ["A√©ronautique", "A√©rospatial"], 
                seniorite: "Senior", experience: 15, tjmBase: 750,
                periodes: [
                    { debut: "2026-02-01", fin: "2026-03-15", type: "indispo" }, // Mission longue en cours
                    { debut: "2026-03-16", fin: "2026-04-10", type: "dispo" },
                    { debut: "2026-04-11", fin: "2026-04-19", type: "indispo" }, // P√¢ques
                    { debut: "2026-04-20", fin: "2026-08-01", type: "dispo" },
                    { debut: "2026-08-02", fin: "2026-08-30", type: "indispo" }, // Cong√©s √©t√©
                    { debut: "2026-08-31", fin: "2026-12-20", type: "dispo" },
                    { debut: "2026-12-21", fin: "2026-12-31", type: "indispo" } // No√´l
                ]
            },
            { 
                id: 8, code: "JDURA", 
                competences: ["M√©catronique", "Simulation", "CATIA"], 
                secteurs: ["Automobile", "A√©ronautique"], 
                seniorite: "Confirm√©", experience: 4, tjmBase: 520,
                periodes: [
                    { debut: "2026-02-12", fin: "2026-06-30", type: "dispo" },
                    { debut: "2026-07-01", fin: "2026-07-19", type: "indispo" }, // Cong√©s √©t√©
                    { debut: "2026-07-20", fin: "2026-10-23", type: "dispo" },
                    { debut: "2026-10-24", fin: "2026-11-01", type: "indispo" }, // Toussaint
                    { debut: "2026-11-02", fin: "2026-12-23", type: "dispo" },
                    { debut: "2026-12-24", fin: "2026-12-31", type: "indispo" } // No√´l
                ]
            },
            { 
                id: 9, code: "CVASS", 
                competences: ["Radar", "Traitement signal", "RF"], 
                secteurs: ["D√©fense"], 
                seniorite: "Senior", experience: 11, tjmBase: 700,
                periodes: [
                    { debut: "2026-02-01", fin: "2026-04-30", type: "indispo" }, // Mission D√©fense longue
                    { debut: "2026-05-01", fin: "2026-07-31", type: "dispo" },
                    { debut: "2026-08-01", fin: "2026-08-23", type: "indispo" }, // Cong√©s √©t√©
                    { debut: "2026-08-24", fin: "2026-11-06", type: "dispo" },
                    { debut: "2026-11-07", fin: "2026-11-15", type: "indispo" }, // 11 novembre √©tendu
                    { debut: "2026-11-16", fin: "2026-12-20", type: "dispo" },
                    { debut: "2026-12-21", fin: "2026-12-31", type: "indispo" } // No√´l
                ]
            },
            { 
                id: 10, code: "NBOUD", 
                competences: ["Ing. Syst√®me", "SysML", "DOORS"], 
                secteurs: ["A√©rospatial", "D√©fense"], 
                seniorite: "Confirm√©", experience: 7, tjmBase: 590,
                periodes: [
                    { debut: "2026-02-28", fin: "2026-05-07", type: "dispo" },
                    { debut: "2026-05-08", fin: "2026-05-24", type: "indispo" }, // Ponts de mai
                    { debut: "2026-05-25", fin: "2026-07-17", type: "dispo" },
                    { debut: "2026-07-18", fin: "2026-08-09", type: "indispo" }, // Cong√©s √©t√©
                    { debut: "2026-08-10", fin: "2026-12-18", type: "dispo" },
                    { debut: "2026-12-19", fin: "2026-12-31", type: "indispo" } // No√´l
                ]
            },
            { 
                id: 11, code: "RFONT", 
                competences: ["Validation", "HIL", "Banc de test"], 
                secteurs: ["Automobile"], 
                seniorite: "Junior", experience: 3, tjmBase: 450,
                periodes: [
                    { debut: "2026-02-01", fin: "2026-03-31", type: "indispo" }, // Mission en cours
                    { debut: "2026-04-01", fin: "2026-07-24", type: "dispo" },
                    { debut: "2026-07-25", fin: "2026-08-09", type: "indispo" }, // Cong√©s √©t√©
                    { debut: "2026-08-10", fin: "2026-12-23", type: "dispo" },
                    { debut: "2026-12-24", fin: "2026-12-31", type: "indispo" } // No√´l
                ]
            },
            { 
                id: 12, code: "EPIER", 
                competences: ["Cybers√©curit√©", "ISO 21434", "TARA"], 
                secteurs: ["Automobile", "D√©fense"], 
                seniorite: "Confirm√©", experience: 5, tjmBase: 620,
                periodes: [
                    { debut: "2026-02-14", fin: "2026-04-17", type: "dispo" },
                    { debut: "2026-04-18", fin: "2026-04-26", type: "indispo" }, // P√¢ques
                    { debut: "2026-04-27", fin: "2026-08-14", type: "dispo" },
                    { debut: "2026-08-15", fin: "2026-09-06", type: "indispo" }, // Cong√©s √©t√© (Assomption)
                    { debut: "2026-09-07", fin: "2026-12-20", type: "dispo" },
                    { debut: "2026-12-21", fin: "2026-12-31", type: "indispo" } // No√´l
                ]
            },
            { 
                id: 13, code: "HMICH", 
                competences: ["Propulsion", "Thermique", "CFD"], 
                secteurs: ["A√©rospatial", "A√©ronautique"], 
                seniorite: "Senior", experience: 9, tjmBase: 690,
                periodes: [
                    { debut: "2026-02-01", fin: "2026-02-28", type: "indispo" }, // Vacances f√©vrier
                    { debut: "2026-03-01", fin: "2026-06-30", type: "dispo" },
                    { debut: "2026-07-01", fin: "2026-07-12", type: "indispo" }, // Cong√©s √©t√©
                    { debut: "2026-07-13", fin: "2026-08-14", type: "dispo" },
                    { debut: "2026-08-15", fin: "2026-08-30", type: "indispo" }, // Assomption + fin ao√ªt
                    { debut: "2026-08-31", fin: "2026-12-18", type: "dispo" },
                    { debut: "2026-12-19", fin: "2026-12-31", type: "indispo" } // No√´l
                ]
            },
            { 
                id: 14, code: "YPETI", 
                competences: ["IHM", "Ergonomie", "Qt/QML"], 
                secteurs: ["A√©ronautique", "Automobile", "D√©fense"], 
                seniorite: "Confirm√©", experience: 6, tjmBase: 560,
                periodes: [
                    { debut: "2026-02-21", fin: "2026-05-14", type: "dispo" },
                    { debut: "2026-05-15", fin: "2026-05-24", type: "indispo" }, // Pont Ascension
                    { debut: "2026-05-25", fin: "2026-07-31", type: "dispo" },
                    { debut: "2026-08-01", fin: "2026-08-16", type: "indispo" }, // Cong√©s √©t√©
                    { debut: "2026-08-17", fin: "2026-10-23", type: "dispo" },
                    { debut: "2026-10-24", fin: "2026-11-01", type: "indispo" }, // Toussaint
                    { debut: "2026-11-02", fin: "2026-12-23", type: "dispo" },
                    { debut: "2026-12-24", fin: "2026-12-31", type: "indispo" } // No√´l
                ]
            },
            { 
                id: 15, code: "KLERO", 
                competences: ["√âlectronique puissance", "Batterie", "BMS"], 
                secteurs: ["Automobile", "A√©rospatial"], 
                seniorite: "Junior", experience: 2, tjmBase: 480,
                periodes: [
                    { debut: "2026-02-01", fin: "2026-04-10", type: "indispo" }, // Stage/Mission
                    { debut: "2026-04-11", fin: "2026-07-31", type: "dispo" },
                    { debut: "2026-08-01", fin: "2026-08-16", type: "indispo" }, // Cong√©s √©t√©
                    { debut: "2026-08-17", fin: "2026-12-20", type: "dispo" },
                    { debut: "2026-12-21", fin: "2026-12-31", type: "indispo" } // No√´l
                ]
            }
        ];
        
        const grilleTarifaire = [
            { duree: "1 mois", remise: 0 },
            { duree: "3 mois", remise: 8 },
            { duree: "6 mois", remise: 11 }
        ];
        
        const allCompetences = [...new Set(consultantsData.flatMap(c => c.competences))].sort();
        const allSecteurs = ["D√©fense", "A√©ronautique", "A√©rospatial", "Automobile"];
        const secteurIcons = { "D√©fense": "üõ°Ô∏è", "A√©ronautique": "‚úàÔ∏è", "A√©rospatial": "üöÄ", "Automobile": "üöó" };
        
        const Header = ({ client }) => (
            <header style={{ background: 'linear-gradient(135deg, #1a365d 0%, #2c5282 100%)', padding: '16px 32px', display: 'flex', justifyContent: 'space-between', alignItems: 'center', boxShadow: '0 2px 8px rgba(0,0,0,0.15)' }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
                    <div style={{ background: 'white', borderRadius: '8px', padding: '8px 16px', fontWeight: 'bold', color: '#1a365d', fontSize: '18px' }}>CENTUM T&S</div>
                    <span style={{ color: 'rgba(255,255,255,0.7)', fontSize: '14px' }}>Portail Partenaires</span>
                </div>
                <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
                    <span style={{ color: 'white', fontSize: '14px' }}>Bienvenue, <strong>{client}</strong></span>
                    <button style={{ background: 'rgba(255,255,255,0.15)', border: '1px solid rgba(255,255,255,0.3)', color: 'white', padding: '8px 16px', borderRadius: '6px', cursor: 'pointer', fontSize: '13px' }}>D√©connexion</button>
                </div>
            </header>
        );
        
        const Filtres = ({ filters, setFilters, consultantCount, totalCount }) => (
            <div style={{ background: 'white', padding: '20px 24px', borderRadius: '12px', marginBottom: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                <div style={{ display: 'flex', gap: '16px', flexWrap: 'wrap', alignItems: 'flex-end' }}>
                    <div>
                        <label style={{ display: 'block', fontSize: '11px', fontWeight: '600', color: '#64748b', marginBottom: '6px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>Secteur d'activit√©</label>
                        <select value={filters.secteur} onChange={(e) => setFilters({...filters, secteur: e.target.value})} style={{ padding: '10px 14px', borderRadius: '8px', border: '1px solid #e2e8f0', fontSize: '14px', minWidth: '180px', background: 'white' }}>
                            <option value="">Tous les secteurs</option>
                            {allSecteurs.map(s => <option key={s} value={s}>{secteurIcons[s]} {s}</option>)}
                        </select>
                    </div>
                    <div>
                        <label style={{ display: 'block', fontSize: '11px', fontWeight: '600', color: '#64748b', marginBottom: '6px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>Comp√©tences</label>
                        <select value={filters.competence} onChange={(e) => setFilters({...filters, competence: e.target.value})} style={{ padding: '10px 14px', borderRadius: '8px', border: '1px solid #e2e8f0', fontSize: '14px', minWidth: '180px', background: 'white' }}>
                            <option value="">Toutes</option>
                            {allCompetences.map(c => <option key={c} value={c}>{c}</option>)}
                        </select>
                    </div>
                    <div>
                        <label style={{ display: 'block', fontSize: '11px', fontWeight: '600', color: '#64748b', marginBottom: '6px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>S√©niorit√©</label>
                        <select value={filters.seniorite} onChange={(e) => setFilters({...filters, seniorite: e.target.value})} style={{ padding: '10px 14px', borderRadius: '8px', border: '1px solid #e2e8f0', fontSize: '14px', minWidth: '140px', background: 'white' }}>
                            <option value="">Toutes</option>
                            <option value="Junior">Junior</option>
                            <option value="Confirm√©">Confirm√©</option>
                            <option value="Senior">Senior</option>
                        </select>
                    </div>
                    <button onClick={() => setFilters({ competence: '', seniorite: '', secteur: '' })} style={{ padding: '10px 16px', borderRadius: '8px', border: '1px solid #e2e8f0', background: 'white', fontSize: '13px', cursor: 'pointer', color: '#64748b' }}>‚úï R√©initialiser</button>
                    <div style={{ marginLeft: 'auto', color: '#64748b', fontSize: '14px', background: '#f1f5f9', padding: '10px 16px', borderRadius: '8px' }}>
                        <strong style={{ color: '#1a365d', fontSize: '18px' }}>{consultantCount}</strong>
                        <span style={{ color: '#94a3b8' }}> / {totalCount} profils</span>
                    </div>
                </div>
            </div>
        );
        
        // Timeline V2 - Style Booking - F√©vrier √† D√©cembre 2026 - RESPONSIVE
        const TimelineBooking = ({ consultants, onReserver }) => {
            const startDate = new Date('2026-02-01');
            const endDate = new Date('2026-12-31');
            const totalDays = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1;
            
            // G√©n√©rer les mois
            const months = [];
            let currentMonth = new Date(startDate);
            while (currentMonth <= endDate) {
                const year = currentMonth.getFullYear();
                const month = currentMonth.getMonth();
                const firstOfMonth = new Date(year, month, 1);
                const lastOfMonth = new Date(year, month + 1, 0);
                
                const effectiveStart = firstOfMonth < startDate ? startDate : firstOfMonth;
                const effectiveEnd = lastOfMonth > endDate ? endDate : lastOfMonth;
                
                const daysInView = Math.ceil((effectiveEnd - effectiveStart) / (1000 * 60 * 60 * 24)) + 1;
                
                months.push({
                    key: `${year}-${month}`,
                    name: currentMonth.toLocaleDateString('fr-FR', { month: 'short' }).toUpperCase(),
                    fullName: currentMonth.toLocaleDateString('fr-FR', { month: 'long' }),
                    days: daysInView,
                    widthPercent: (daysInView / totalDays) * 100
                });
                
                currentMonth = new Date(year, month + 1, 1);
            }
            
            const getDayPositionPercent = (dateStr) => {
                const date = new Date(dateStr);
                const clampedDate = date < startDate ? startDate : (date > endDate ? endDate : date);
                const diffTime = clampedDate - startDate;
                const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                return (diffDays / totalDays) * 100;
            };
            
            const getDayWidthPercent = (startStr, endStr) => {
                const start = new Date(startStr);
                const end = new Date(endStr);
                const effectiveStart = start < startDate ? startDate : start;
                const effectiveEnd = end > endDate ? endDate : end;
                const diffTime = effectiveEnd - effectiveStart;
                const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24)) + 1;
                return Math.max(0, (diffDays / totalDays) * 100);
            };
            
            const getSenioriteStyle = (sen) => {
                if (sen === 'Senior') return { bg: '#fef3c7', border: '#f59e0b', text: '#92400e' };
                if (sen === 'Confirm√©') return { bg: '#dbeafe', border: '#3b82f6', text: '#1e40af' };
                return { bg: '#dcfce7', border: '#22c55e', text: '#166534' };
            };
            
            const formatDateShort = (dateStr) => {
                const d = new Date(dateStr);
                return d.toLocaleDateString('fr-FR', { day: 'numeric', month: 'short' });
            };
            
            const sortedConsultants = [...consultants].sort((a, b) => {
                const aFirstDispo = a.periodes.find(p => p.type === 'dispo');
                const bFirstDispo = b.periodes.find(p => p.type === 'dispo');
                if (!aFirstDispo) return 1;
                if (!bFirstDispo) return -1;
                return new Date(aFirstDispo.debut) - new Date(bFirstDispo.debut);
            });
            
            return (
                <div style={{ background: 'white', borderRadius: '16px', boxShadow: '0 2px 12px rgba(0,0,0,0.08)', overflow: 'hidden' }}>
                    {/* Header */}
                    <div style={{ background: '#1a365d', color: 'white', padding: '16px 20px', display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
                        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                            <span style={{ fontSize: '24px' }}>üóìÔ∏è</span>
                            <div>
                                <div style={{ fontWeight: '600', fontSize: '16px' }}>Plan de charge 2026</div>
                                <div style={{ fontSize: '12px', opacity: 0.8 }}>Cliquez sur une p√©riode verte pour r√©server</div>
                            </div>
                        </div>
                        <div style={{ display: 'flex', gap: '20px', fontSize: '12px' }}>
                            <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                                <div style={{ width: '24px', height: '12px', background: 'linear-gradient(90deg, #22c55e 0%, #16a34a 100%)', borderRadius: '3px' }}></div>
                                Disponible
                            </div>
                            <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                                <div style={{ width: '24px', height: '12px', background: 'repeating-linear-gradient(45deg, #e2e8f0, #e2e8f0 2px, #cbd5e1 2px, #cbd5e1 4px)', borderRadius: '3px' }}></div>
                                Indisponible
                            </div>
                        </div>
                    </div>
                    
                    <div style={{ display: 'flex', flexDirection: 'column' }}>
                        {/* Header mois */}
                        <div style={{ display: 'flex', background: '#f8fafc', borderBottom: '2px solid #e2e8f0' }}>
                            <div style={{ width: '220px', minWidth: '220px', padding: '12px 16px', fontSize: '11px', fontWeight: '600', color: '#64748b', textTransform: 'uppercase', borderRight: '1px solid #e2e8f0', background: '#f8fafc' }}>
                                Consultant
                            </div>
                            <div style={{ flex: 1, display: 'flex' }}>
                                {months.map((m, i) => (
                                    <div key={m.key} style={{
                                        width: `${m.widthPercent}%`,
                                        textAlign: 'center',
                                        padding: '12px 0',
                                        fontWeight: '600',
                                        color: '#1a365d',
                                        fontSize: '11px',
                                        borderRight: '1px solid #cbd5e1',
                                        background: i % 2 === 0 ? '#f8fafc' : '#f1f5f9'
                                    }}>
                                        {m.name}
                                    </div>
                                ))}
                            </div>
                        </div>
                        
                        {/* Consultants */}
                        {sortedConsultants.map((c, idx) => {
                            const style = getSenioriteStyle(c.seniorite);
                            
                            return (
                                <div key={c.id} style={{ display: 'flex', borderBottom: '1px solid #f1f5f9', background: idx % 2 === 0 ? 'white' : '#fafbfc' }}>
                                    {/* Info consultant */}
                                    <div style={{ width: '220px', minWidth: '220px', padding: '10px 12px', display: 'flex', alignItems: 'center', gap: '10px', borderRight: '1px solid #e2e8f0' }}>
                                        <div 
                                            onClick={() => onReserver(c, null)}
                                            style={{ background: style.bg, border: `2px solid ${style.border}`, color: style.text, padding: '6px 8px', borderRadius: '6px', fontWeight: 'bold', fontSize: '11px', minWidth: '52px', textAlign: 'center', cursor: 'pointer', transition: 'transform 0.15s' }}
                                            onMouseEnter={(e) => e.currentTarget.style.transform = 'scale(1.05)'}
                                            onMouseLeave={(e) => e.currentTarget.style.transform = 'scale(1)'}
                                            title="Cliquez pour r√©server ce consultant"
                                        >
                                            {c.code}
                                        </div>
                                        <div style={{ flex: 1, minWidth: 0 }}>
                                            <div style={{ fontSize: '11px', color: '#374151', fontWeight: '500' }}>
                                                {c.seniorite} ‚Ä¢ <strong>{c.tjmBase}‚Ç¨</strong>/j
                                            </div>
                                            <div style={{ fontSize: '9px', color: '#9ca3af', whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis' }}>
                                                {c.secteurs.map(s => secteurIcons[s]).join('')} {c.competences[0]}
                                            </div>
                                        </div>
                                    </div>
                                    
                                    {/* Timeline responsive */}
                                    <div style={{ flex: 1, position: 'relative', height: '48px', display: 'flex', alignItems: 'center' }}>
                                        {/* Fond mois */}
                                        <div style={{ display: 'flex', height: '100%', position: 'absolute', left: 0, right: 0, top: 0 }}>
                                            {months.map((m, i) => (
                                                <div key={m.key} style={{
                                                    width: `${m.widthPercent}%`,
                                                    background: i % 2 === 0 ? 'transparent' : 'rgba(241,245,249,0.5)',
                                                    borderRight: '1px solid #e2e8f0'
                                                }}></div>
                                            ))}
                                        </div>
                                        
                                        {/* P√©riodes en pourcentage */}
                                        {c.periodes.map((p, pIdx) => {
                                            const leftPercent = getDayPositionPercent(p.debut);
                                            const widthPercent = getDayWidthPercent(p.debut, p.fin);
                                            const isDispo = p.type === 'dispo';
                                            
                                            if (widthPercent <= 0) return null;
                                            
                                            return (
                                                <div
                                                    key={pIdx}
                                                    onClick={() => isDispo && onReserver(c, p)}
                                                    title={isDispo ? `${formatDateShort(p.debut)} ‚Üí ${formatDateShort(p.fin)} ‚Ä¢ Cliquez pour r√©server` : 'Indisponible'}
                                                    style={{
                                                        position: 'absolute',
                                                        left: `${leftPercent}%`,
                                                        width: `calc(${widthPercent}% - 2px)`,
                                                        height: '32px',
                                                        borderRadius: '4px',
                                                        cursor: isDispo ? 'pointer' : 'default',
                                                        background: isDispo 
                                                            ? 'linear-gradient(90deg, #22c55e 0%, #16a34a 100%)'
                                                            : 'repeating-linear-gradient(45deg, #e2e8f0, #e2e8f0 2px, #d1d5db 2px, #d1d5db 4px)',
                                                        border: isDispo ? 'none' : '1px solid #cbd5e1',
                                                        transition: isDispo ? 'transform 0.15s, box-shadow 0.15s' : 'none',
                                                        boxShadow: isDispo ? '0 1px 3px rgba(0,0,0,0.1)' : 'none',
                                                        zIndex: isDispo ? 2 : 1
                                                    }}
                                                    onMouseEnter={(e) => {
                                                        if (isDispo) {
                                                            e.currentTarget.style.transform = 'scaleY(1.2)';
                                                            e.currentTarget.style.boxShadow = '0 4px 12px rgba(34, 197, 94, 0.4)';
                                                            e.currentTarget.style.zIndex = '20';
                                                        }
                                                    }}
                                                    onMouseLeave={(e) => {
                                                        if (isDispo) {
                                                            e.currentTarget.style.transform = 'scaleY(1)';
                                                            e.currentTarget.style.boxShadow = '0 1px 3px rgba(0,0,0,0.1)';
                                                            e.currentTarget.style.zIndex = '2';
                                                        }
                                                    }}
                                                >
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>
                            );
                        })}
                    </div>
                    
                    {/* Footer */}
                    <div style={{ padding: '14px 20px', background: '#f8fafc', borderTop: '1px solid #e2e8f0', display: 'flex', justifyContent: 'space-between', fontSize: '12px', color: '#64748b' }}>
                        <div style={{ display: 'flex', gap: '24px' }}>
                            <span>üí° Survolez une p√©riode pour voir les dates, cliquez pour r√©server</span>
                        </div>
                        <div>F√©vrier ‚Üí D√©cembre 2026</div>
                    </div>
                </div>
            );
        };
        
        const ViewToggle = ({ view, setView }) => (
            <div style={{ display: 'flex', background: '#e2e8f0', borderRadius: '10px', padding: '4px' }}>
                <button onClick={() => setView('timeline')} style={{ padding: '10px 20px', borderRadius: '8px', border: 'none', background: view === 'timeline' ? 'white' : 'transparent', color: view === 'timeline' ? '#1a365d' : '#64748b', fontWeight: view === 'timeline' ? '600' : '400', cursor: 'pointer', fontSize: '14px', display: 'flex', alignItems: 'center', gap: '8px', boxShadow: view === 'timeline' ? '0 2px 4px rgba(0,0,0,0.1)' : 'none' }}>
                    <span>üóìÔ∏è</span> Planning
                </button>
                <button onClick={() => setView('cards')} style={{ padding: '10px 20px', borderRadius: '8px', border: 'none', background: view === 'cards' ? 'white' : 'transparent', color: view === 'cards' ? '#1a365d' : '#64748b', fontWeight: view === 'cards' ? '600' : '400', cursor: 'pointer', fontSize: '14px', display: 'flex', alignItems: 'center', gap: '8px', boxShadow: view === 'cards' ? '0 2px 4px rgba(0,0,0,0.1)' : 'none' }}>
                    <span>‚ñ¶</span> Fiches
                </button>
            </div>
        );
        
        const ConsultantCard = ({ consultant, onInteret }) => {
            const calcTJM = (base, remise) => Math.round(base * (1 - remise / 100));
            const firstDispo = consultant.periodes.find(p => p.type === 'dispo');
            
            return (
                <div style={{ background: 'white', borderRadius: '16px', padding: '24px', boxShadow: '0 2px 12px rgba(0,0,0,0.08)', display: 'flex', flexDirection: 'column', gap: '14px', transition: 'transform 0.2s, box-shadow 0.2s' }}
                    onMouseEnter={(e) => { e.currentTarget.style.transform = 'translateY(-4px)'; e.currentTarget.style.boxShadow = '0 8px 24px rgba(0,0,0,0.12)'; }}
                    onMouseLeave={(e) => { e.currentTarget.style.transform = 'translateY(0)'; e.currentTarget.style.boxShadow = '0 2px 12px rgba(0,0,0,0.08)'; }}>
                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
                        <div>
                            <div style={{ fontSize: '26px', fontWeight: 'bold', color: '#1a365d', letterSpacing: '2px' }}>{consultant.code}</div>
                            <div style={{ fontSize: '13px', color: '#64748b', marginTop: '4px' }}>{consultant.seniorite} ‚Ä¢ {consultant.experience} ans d'exp.</div>
                        </div>
                        <div style={{ background: consultant.seniorite === 'Senior' ? '#fef3c7' : consultant.seniorite === 'Confirm√©' ? '#dbeafe' : '#dcfce7', color: consultant.seniorite === 'Senior' ? '#92400e' : consultant.seniorite === 'Confirm√©' ? '#1e40af' : '#166534', padding: '5px 10px', borderRadius: '20px', fontSize: '11px', fontWeight: '600' }}>{consultant.seniorite}</div>
                    </div>
                    <div style={{ display: 'flex', gap: '6px', flexWrap: 'wrap' }}>
                        {consultant.secteurs.map(s => <span key={s} style={{ background: '#f8fafc', border: '1px solid #e2e8f0', padding: '4px 8px', borderRadius: '4px', fontSize: '11px', color: '#475569' }}>{secteurIcons[s]} {s}</span>)}
                    </div>
                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>
                        {consultant.competences.map(comp => <span key={comp} style={{ background: '#eff6ff', color: '#1e40af', padding: '5px 10px', borderRadius: '6px', fontSize: '12px', fontWeight: '500' }}>{comp}</span>)}
                    </div>
                    
                    {/* Mini timeline dans la card */}
                    <div style={{ background: '#f8fafc', borderRadius: '8px', padding: '12px', border: '1px solid #e2e8f0' }}>
                        <div style={{ fontSize: '11px', fontWeight: '600', color: '#64748b', marginBottom: '8px', textTransform: 'uppercase' }}>Prochaines disponibilit√©s</div>
                        <div style={{ display: 'flex', gap: '4px', flexWrap: 'wrap' }}>
                            {consultant.periodes.filter(p => p.type === 'dispo').slice(0, 3).map((p, i) => {
                                const debut = new Date(p.debut).toLocaleDateString('fr-FR', { day: 'numeric', month: 'short' });
                                const fin = new Date(p.fin).toLocaleDateString('fr-FR', { day: 'numeric', month: 'short' });
                                return (
                                    <span key={i} style={{
                                        padding: '4px 8px',
                                        borderRadius: '4px',
                                        fontSize: '10px',
                                        fontWeight: '500',
                                        background: '#dcfce7',
                                        color: '#166534',
                                        border: '1px solid #bbf7d0'
                                    }}>
                                        {debut} ‚Üí {fin}
                                    </span>
                                );
                            })}
                        </div>
                    </div>
                    
                    <div style={{ background: '#f8fafc', borderRadius: '10px', padding: '14px', border: '1px solid #e2e8f0' }}>
                        <div style={{ fontSize: '11px', fontWeight: '600', color: '#64748b', marginBottom: '10px', textTransform: 'uppercase' }}>Tarif journalier selon engagement</div>
                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                            {grilleTarifaire.map(g => (
                                <div key={g.duree} style={{ textAlign: 'center', flex: 1 }}>
                                    <div style={{ fontSize: '11px', color: '#94a3b8', marginBottom: '4px' }}>{g.duree}</div>
                                    <div style={{ fontSize: '18px', fontWeight: 'bold', color: '#1a365d' }}>{calcTJM(consultant.tjmBase, g.remise)} ‚Ç¨</div>
                                    {g.remise > 0 && <div style={{ fontSize: '10px', color: '#10b981', fontWeight: '600' }}>-{g.remise}%</div>}
                                </div>
                            ))}
                        </div>
                    </div>
                    <button onClick={() => firstDispo && onInteret(consultant, firstDispo)} style={{ background: 'linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)', color: 'white', border: 'none', padding: '12px 20px', borderRadius: '10px', fontSize: '14px', fontWeight: '600', cursor: 'pointer', marginTop: 'auto' }}
                        onMouseEnter={(e) => { e.currentTarget.style.transform = 'scale(1.02)'; e.currentTarget.style.boxShadow = '0 4px 12px rgba(37, 99, 235, 0.4)'; }}
                        onMouseLeave={(e) => { e.currentTarget.style.transform = 'scale(1)'; e.currentTarget.style.boxShadow = 'none'; }}>
                        Je suis int√©ress√© ‚Üí
                    </button>
                </div>
            );
        };
        
        const ModalReservation = ({ consultant, periode, onClose, onSubmit }) => {
            // Trouver la premi√®re dispo et la derni√®re date
            const firstDispo = consultant?.periodes.find(p => p.type === 'dispo');
            const lastPeriode = consultant?.periodes[consultant.periodes.length - 1];
            
            const [dateDebut, setDateDebut] = useState(periode?.debut || firstDispo?.debut || '');
            const [dateFin, setDateFin] = useState(periode?.fin || lastPeriode?.fin || '');
            const [commentaire, setCommentaire] = useState('');
            
            if (!consultant) return null;
            
            const calcTJM = (base, remise) => Math.round(base * (1 - remise / 100));
            
            // Calculer les jours facturables (jours ouvr√©s hors indispos)
            const calculerJoursFacturables = () => {
                if (!dateDebut || !dateFin) return { calendaires: 0, ouvres: 0, facturables: 0, indispos: [] };
                
                const start = new Date(dateDebut);
                const end = new Date(dateFin);
                const joursCalendaires = Math.ceil((end - start) / (1000 * 60 * 60 * 24)) + 1;
                
                // Jours f√©ri√©s France 2026
                const feriesFrance2026 = [
                    '2026-01-01', // Jour de l'an
                    '2026-04-06', // Lundi de P√¢ques
                    '2026-05-01', // F√™te du travail
                    '2026-05-08', // Victoire 1945
                    '2026-05-14', // Ascension
                    '2026-05-25', // Lundi de Pentec√¥te
                    '2026-07-14', // F√™te nationale
                    '2026-08-15', // Assomption
                    '2026-11-01', // Toussaint
                    '2026-11-11', // Armistice
                    '2026-12-25', // No√´l
                ];
                
                // Compter les jours ouvr√©s (hors week-ends et f√©ri√©s)
                let joursOuvres = 0;
                let currentDate = new Date(start);
                while (currentDate <= end) {
                    const dayOfWeek = currentDate.getDay();
                    const dateStr = currentDate.toISOString().split('T')[0];
                    if (dayOfWeek !== 0 && dayOfWeek !== 6 && !feriesFrance2026.includes(dateStr)) {
                        joursOuvres++;
                    }
                    currentDate.setDate(currentDate.getDate() + 1);
                }
                
                // Calculer les jours d'indispo (en jours ouvr√©s)
                let joursIndispoOuvres = 0;
                const indispos = [];
                
                consultant.periodes.filter(p => p.type === 'indispo').forEach(p => {
                    const pStart = new Date(p.debut);
                    const pEnd = new Date(p.fin);
                    
                    // Chevauchement avec la p√©riode s√©lectionn√©e
                    const overlapStart = pStart < start ? start : pStart;
                    const overlapEnd = pEnd > end ? end : pEnd;
                    
                    if (overlapStart <= overlapEnd) {
                        // Compter jours ouvr√©s dans cette p√©riode d'indispo
                        let joursOuvresIndispo = 0;
                        let d = new Date(overlapStart);
                        while (d <= overlapEnd) {
                            const dayOfWeek = d.getDay();
                            const dateStr = d.toISOString().split('T')[0];
                            if (dayOfWeek !== 0 && dayOfWeek !== 6 && !feriesFrance2026.includes(dateStr)) {
                                joursOuvresIndispo++;
                            }
                            d.setDate(d.getDate() + 1);
                        }
                        
                        if (joursOuvresIndispo > 0) {
                            joursIndispoOuvres += joursOuvresIndispo;
                            indispos.push({
                                debut: overlapStart.toLocaleDateString('fr-FR', { day: 'numeric', month: 'short' }),
                                fin: overlapEnd.toLocaleDateString('fr-FR', { day: 'numeric', month: 'short' }),
                                jours: joursOuvresIndispo
                            });
                        }
                    }
                });
                
                return {
                    calendaires: joursCalendaires,
                    ouvres: joursOuvres,
                    facturables: Math.max(0, joursOuvres - joursIndispoOuvres),
                    indispos
                };
            };
            
            const { calendaires, ouvres, facturables, indispos } = calculerJoursFacturables();
            const ETP_REFERENCE = 218; // Jours ouvr√©s par ETP (365 - 104 WE - 25 CP - 11 f√©ri√©s - 7 RTT)
            const etp = facturables / ETP_REFERENCE;
            const dureeMois = facturables / 22; // ~22 jours ouvr√©s par mois
            const remise = dureeMois >= 6 ? 11 : dureeMois >= 3 ? 8 : 0;
            const tjmApplique = calcTJM(consultant.tjmBase, remise);
            const montantTotal = facturables * tjmApplique;
            
            // State pour tracker si l'utilisateur a d√©j√† optimis√©
            const [aAtteintPalier, setAAtteintPalier] = useState(false);
            const [aAtteintFinMois, setAAtteintFinMois] = useState(false);
            
            // Validation des dates
            const datesValides = dateDebut && dateFin && new Date(dateDebut) <= new Date(dateFin);
            const dateDebutSuperieure = dateDebut && dateFin && new Date(dateDebut) > new Date(dateFin);
            
            // Ajuster dateFin si dateDebut change et devient sup√©rieure
            const handleDateDebutChange = (newDateDebut) => {
                setDateDebut(newDateDebut);
                if (dateFin && new Date(newDateDebut) > new Date(dateFin)) {
                    setDateFin(newDateDebut);
                }
            };
            
            // Reset les flags si la date change manuellement
            React.useEffect(() => {
                setAAtteintPalier(false);
                setAAtteintFinMois(false);
            }, [dateDebut]);
            
            // Calcul prochain palier (seulement le prochain, pas le max)
            const getProchainPalier = () => {
                if (aAtteintFinMois) return null; // L'utilisateur a d√©j√† optimis√© jusqu'√† fin de mois
                if (dureeMois >= 6) return null; // D√©j√† au max
                
                // Prochain palier seulement (pas sauter de 0 √† 11)
                const palierCible = remise === 0 ? 3 : 6;
                const joursOuvresCible = palierCible * 22;
                const joursManquants = joursOuvresCible - facturables;
                
                if (joursManquants <= 0) return null;
                if (joursManquants > 44) return null; // Trop loin, pas pertinent (> 2 mois)
                
                // Estimer la date de fin n√©cessaire
                const joursCalendairesAjouter = Math.ceil(joursManquants * 1.5);
                const nouvelleDateFin = new Date(dateFin);
                nouvelleDateFin.setDate(nouvelleDateFin.getDate() + joursCalendairesAjouter);
                
                // Fin de mois de la date actuelle
                const finDeMoisActuel = new Date(new Date(dateFin).getFullYear(), new Date(dateFin).getMonth() + 1, 0);
                
                // Fin de mois de la nouvelle date cible
                const finDeMoisCible = new Date(nouvelleDateFin.getFullYear(), nouvelleDateFin.getMonth() + 1, 0);
                
                const remiseCible = palierCible >= 6 ? 11 : 8;
                
                // Si on a d√©j√† atteint le palier, proposer seulement fin de mois si pertinent
                if (aAtteintPalier) {
                    const dateFinActuelle = new Date(dateFin);
                    const joursDuMois = finDeMoisActuel.getDate();
                    const jourActuel = dateFinActuelle.getDate();
                    
                    // Proposer fin de mois seulement si on n'y est pas d√©j√† et si c'est dans les 15 jours
                    if (jourActuel < joursDuMois && (joursDuMois - jourActuel) <= 15) {
                        return {
                            type: 'finMois',
                            dateFinMois: finDeMoisActuel.toISOString().split('T')[0],
                            moisLabel: finDeMoisActuel.toLocaleDateString('fr-FR', { month: 'long' })
                        };
                    }
                    return null;
                }
                
                return {
                    type: 'palier',
                    palier: palierCible,
                    remiseCible,
                    joursManquants,
                    dateCible: nouvelleDateFin.toISOString().split('T')[0],
                    labelPalier: palierCible >= 6 ? '6 mois' : '3 mois'
                };
            };
            
            const prochainPalier = getProchainPalier();
            
            const handleEtendrePalier = (date) => {
                setDateFin(date);
                setAAtteintPalier(true);
            };
            
            const handleEtendreFinMois = (date) => {
                setDateFin(date);
                setAAtteintFinMois(true);
            };
            
            // Labels explicatifs pour les remises
            const getRemiseExplication = () => {
                if (remise === 11) return "Remise maximale pour engagement ‚â• 6 mois";
                if (remise === 8) return "Remise pour engagement ‚â• 3 mois";
                return "Tarif standard (engagement < 3 mois)";
            };
            
            return (
                <div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, background: 'rgba(0,0,0,0.5)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 1000 }} onClick={onClose}>
                    <div style={{ background: 'white', borderRadius: '20px', padding: '32px', maxWidth: '560px', width: '90%', maxHeight: '90vh', overflow: 'auto' }} onClick={e => e.stopPropagation()}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '24px' }}>
                            <h2 style={{ fontSize: '20px', color: '#1a365d', margin: 0 }}>Exprimer mon int√©r√™t</h2>
                            <button onClick={onClose} style={{ background: 'none', border: 'none', fontSize: '24px', cursor: 'pointer', color: '#94a3b8' }}>√ó</button>
                        </div>
                        
                        <div style={{ background: '#f8fafc', border: '1px solid #e2e8f0', padding: '16px', borderRadius: '12px', marginBottom: '24px', display: 'flex', alignItems: 'center', gap: '16px' }}>
                            <div style={{ background: '#1a365d', color: 'white', width: '56px', height: '56px', borderRadius: '12px', display: 'flex', alignItems: 'center', justifyContent: 'center', fontWeight: 'bold', fontSize: '14px' }}>{consultant.code}</div>
                            <div>
                                <div style={{ fontWeight: '600', color: '#1a365d' }}>{consultant.seniorite} ‚Ä¢ {consultant.experience} ans ‚Ä¢ {consultant.tjmBase}‚Ç¨/j</div>
                                <div style={{ fontSize: '13px', color: '#64748b' }}>{consultant.competences.join(', ')}</div>
                            </div>
                        </div>
                        
                        <div style={{ background: '#eff6ff', padding: '12px 16px', borderRadius: '8px', marginBottom: '20px', fontSize: '13px', color: '#1e40af' }}>
                            üí° Indiquez la p√©riode souhait√©e. Les indisponibilit√©s sont automatiquement exclues du calcul.
                        </div>
                        
                        <div style={{ display: 'flex', gap: '16px', marginBottom: '20px' }}>
                            <div style={{ flex: 1 }}>
                                <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: '#374151', marginBottom: '8px' }}>Date de d√©but</label>
                                <input type="date" value={dateDebut} onChange={(e) => handleDateDebutChange(e.target.value)} style={{ width: '100%', padding: '12px 14px', borderRadius: '8px', border: '1px solid #e2e8f0', fontSize: '14px' }} />
                            </div>
                            <div style={{ flex: 1 }}>
                                <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: '#374151', marginBottom: '8px' }}>Date de fin</label>
                                <input type="date" value={dateFin} min={dateDebut} onChange={(e) => setDateFin(e.target.value)} style={{ width: '100%', padding: '12px 14px', borderRadius: '8px', border: dateDebutSuperieure ? '2px solid #dc2626' : '1px solid #e2e8f0', fontSize: '14px' }} />
                            </div>
                        </div>
                        
                        {/* Message d'erreur si dates invalides */}
                        {dateDebutSuperieure && (
                            <div style={{ background: '#fef2f2', border: '1px solid #fecaca', borderRadius: '8px', padding: '12px', marginBottom: '20px', fontSize: '13px', color: '#dc2626', display: 'flex', alignItems: 'center', gap: '8px' }}>
                                ‚ö†Ô∏è La date de fin doit √™tre post√©rieure √† la date de d√©but
                            </div>
                        )}
                        
                        {datesValides && calendaires > 0 && (
                            <>
                                {/* R√©sum√© des indispos */}
                                {indispos.length > 0 && (
                                    <div style={{ background: '#fef3c7', border: '1px solid #fbbf24', borderRadius: '10px', padding: '14px', marginBottom: '16px' }}>
                                        <div style={{ fontSize: '12px', fontWeight: '600', color: '#92400e', marginBottom: '8px' }}>‚ö†Ô∏è P√©riodes d'indisponibilit√© dans votre s√©lection :</div>
                                        <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap' }}>
                                            {indispos.map((ind, i) => (
                                                <span key={i} style={{ background: 'white', padding: '4px 10px', borderRadius: '4px', fontSize: '11px', color: '#92400e', border: '1px solid #fbbf24' }}>
                                                    {ind.debut} ‚Üí {ind.fin} ({ind.jours}j)
                                                </span>
                                            ))}
                                        </div>
                                    </div>
                                )}
                                
                                {/* Calcul facturation */}
                                <div style={{ background: '#f0fdf4', border: '2px solid #22c55e', borderRadius: '12px', padding: '20px', marginBottom: '20px' }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '16px', gap: '12px' }}>
                                        <div style={{ textAlign: 'center' }}>
                                            <div style={{ fontSize: '12px', color: '#64748b' }}>Calendaires</div>
                                            <div style={{ fontSize: '18px', fontWeight: '600', color: '#94a3b8' }}>{calendaires}j</div>
                                        </div>
                                        <div style={{ color: '#94a3b8', alignSelf: 'center' }}>‚Üí</div>
                                        <div style={{ textAlign: 'center' }}>
                                            <div style={{ fontSize: '12px', color: '#64748b' }}>Jours ouvr√©s</div>
                                            <div style={{ fontSize: '18px', fontWeight: '600', color: '#374151' }}>{ouvres}j</div>
                                        </div>
                                        <div style={{ color: '#dc2626', alignSelf: 'center', fontWeight: '600' }}>‚àí</div>
                                        <div style={{ textAlign: 'center' }}>
                                            <div style={{ fontSize: '12px', color: '#64748b' }}>Indisponibles</div>
                                            <div style={{ fontSize: '18px', fontWeight: '600', color: '#dc2626' }}>{ouvres - facturables}j</div>
                                        </div>
                                        <div style={{ color: '#16a34a', alignSelf: 'center', fontWeight: '600' }}>=</div>
                                        <div style={{ textAlign: 'center', background: '#dcfce7', padding: '8px 16px', borderRadius: '8px', marginLeft: '8px' }}>
                                            <div style={{ fontSize: '12px', color: '#16a34a', fontWeight: '600' }}>Facturables</div>
                                            <div style={{ fontSize: '22px', fontWeight: '700', color: '#16a34a' }}>{facturables}j</div>
                                            <div style={{ fontSize: '11px', color: '#166534', fontWeight: '600' }}>{etp.toFixed(2)} ETP</div>
                                        </div>
                                    </div>
                                    <div style={{ borderTop: '1px solid #bbf7d0', paddingTop: '16px', display: 'flex', justifyContent: 'space-between', alignItems: 'flex-end' }}>
                                        <div>
                                            <div style={{ fontSize: '13px', color: '#64748b' }}>Tarif applicable</div>
                                            <div style={{ fontSize: '18px', fontWeight: '600', color: '#1a365d' }}>
                                                {tjmApplique} ‚Ç¨/jour
                                                {remise > 0 && <span style={{ fontSize: '12px', color: '#10b981', marginLeft: '8px' }}>(-{remise}%)</span>}
                                            </div>
                                            <div style={{ fontSize: '11px', color: '#64748b', marginTop: '2px' }}>{getRemiseExplication()}</div>
                                        </div>
                                        <div style={{ textAlign: 'right' }}>
                                            <div style={{ fontSize: '13px', color: '#64748b' }}>Budget indicatif</div>
                                            <div style={{ fontSize: '28px', fontWeight: '700', color: '#1a365d' }}>{montantTotal.toLocaleString('fr-FR')} ‚Ç¨</div>
                                            <div style={{ fontSize: '11px', color: '#64748b' }}>soit {Math.round(montantTotal / etp).toLocaleString('fr-FR')} ‚Ç¨ / ETP (base 218j)</div>
                                        </div>
                                    </div>
                                </div>
                                
                                {/* Teaser prochain palier - progressif */}
                                {prochainPalier && prochainPalier.type === 'palier' && (
                                    <div style={{ background: '#fef3c7', border: '1px solid #fbbf24', borderRadius: '10px', padding: '16px', marginBottom: '20px' }}>
                                        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', flexWrap: 'wrap', gap: '12px' }}>
                                            <div style={{ fontSize: '13px', color: '#92400e' }}>
                                                üí° <strong>~{prochainPalier.joursManquants}j</strong> de plus pour <strong>-{prochainPalier.remiseCible}%</strong>
                                            </div>
                                            <button 
                                                onClick={() => handleEtendrePalier(prochainPalier.dateCible)}
                                                style={{ 
                                                    padding: '8px 14px', 
                                                    borderRadius: '6px', 
                                                    border: 'none', 
                                                    background: '#f59e0b', 
                                                    color: 'white', 
                                                    fontSize: '12px', 
                                                    fontWeight: '600', 
                                                    cursor: 'pointer'
                                                }}
                                            >
                                                √âtendre au {new Date(prochainPalier.dateCible).toLocaleDateString('fr-FR', { day: 'numeric', month: 'short' })}
                                            </button>
                                        </div>
                                    </div>
                                )}
                                
                                {prochainPalier && prochainPalier.type === 'finMois' && (
                                    <div style={{ background: '#f0fdf4', border: '1px solid #86efac', borderRadius: '10px', padding: '16px', marginBottom: '20px' }}>
                                        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', flexWrap: 'wrap', gap: '12px' }}>
                                            <div style={{ fontSize: '13px', color: '#166534' }}>
                                                üìÖ Aller jusqu'√† fin {prochainPalier.moisLabel} ?
                                            </div>
                                            <button 
                                                onClick={() => handleEtendreFinMois(prochainPalier.dateFinMois)}
                                                style={{ 
                                                    padding: '8px 14px', 
                                                    borderRadius: '6px', 
                                                    border: '1px solid #22c55e', 
                                                    background: 'white', 
                                                    color: '#166534', 
                                                    fontSize: '12px', 
                                                    fontWeight: '500', 
                                                    cursor: 'pointer'
                                                }}
                                            >
                                                Fin {prochainPalier.moisLabel}
                                            </button>
                                        </div>
                                    </div>
                                )}
                            </>
                        )}
                        
                        <div style={{ marginBottom: '24px' }}>
                            <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: '#374151', marginBottom: '8px' }}>Commentaire (optionnel)</label>
                            <textarea value={commentaire} onChange={(e) => setCommentaire(e.target.value)} placeholder="Contexte de la mission, environnement technique..." style={{ width: '100%', padding: '12px 14px', borderRadius: '8px', border: '1px solid #e2e8f0', fontSize: '14px', minHeight: '80px', resize: 'vertical', fontFamily: 'inherit' }} />
                        </div>
                        
                        <div style={{ display: 'flex', gap: '12px' }}>
                            <button onClick={onClose} style={{ flex: 1, padding: '14px', borderRadius: '10px', border: '1px solid #e2e8f0', background: 'white', fontSize: '15px', cursor: 'pointer', color: '#64748b' }}>Annuler</button>
                            <button 
                                onClick={() => datesValides && onSubmit({ consultant, dateDebut, dateFin, commentaire, tjmApplique, joursFacturables: facturables, montantTotal })} 
                                disabled={!datesValides}
                                style={{ 
                                    flex: 2, 
                                    padding: '14px', 
                                    borderRadius: '10px', 
                                    border: 'none', 
                                    background: datesValides ? 'linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)' : '#e2e8f0', 
                                    color: datesValides ? 'white' : '#94a3b8', 
                                    fontSize: '15px', 
                                    fontWeight: '600', 
                                    cursor: datesValides ? 'pointer' : 'not-allowed' 
                                }}
                            >
                                {datesValides ? 'Envoyer ma demande ‚Üí' : 'S√©lectionnez des dates valides'}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };
        
        const ModalConfirmation = ({ onClose }) => (
            <div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, background: 'rgba(0,0,0,0.5)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 1000 }} onClick={onClose}>
                <div style={{ background: 'white', borderRadius: '20px', padding: '40px', maxWidth: '420px', width: '90%', textAlign: 'center' }} onClick={e => e.stopPropagation()}>
                    <div style={{ width: '72px', height: '72px', background: '#dcfce7', borderRadius: '50%', display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto 24px', fontSize: '36px' }}>‚úì</div>
                    <h2 style={{ fontSize: '22px', color: '#1a365d', marginBottom: '12px' }}>Demande envoy√©e !</h2>
                    <p style={{ color: '#64748b', marginBottom: '24px', lineHeight: '1.6' }}>Nous avons bien re√ßu votre int√©r√™t. Souhaitez-vous planifier un √©change pour en discuter ?</p>
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                        <a 
                            href="https://cal.com/centum/rdv-profil" 
                            target="_blank" 
                            rel="noopener noreferrer"
                            style={{ 
                                display: 'flex', 
                                alignItems: 'center', 
                                justifyContent: 'center',
                                gap: '10px',
                                padding: '14px 24px', 
                                borderRadius: '10px', 
                                border: 'none', 
                                background: 'linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)', 
                                color: 'white', 
                                fontSize: '15px', 
                                fontWeight: '600', 
                                cursor: 'pointer',
                                textDecoration: 'none'
                            }}
                        >
                            üìÖ Planifier un RDV
                        </a>
                        <button onClick={onClose} style={{ padding: '12px 24px', borderRadius: '10px', border: '1px solid #e2e8f0', background: 'white', color: '#64748b', fontSize: '14px', cursor: 'pointer' }}>Plus tard</button>
                    </div>
                </div>
            </div>
        );
        
        const RequestCard = ({ onRequest, hasResults, filters }) => {
            const hasActiveFilters = filters.secteur || filters.competence || filters.seniorite;
            return (
                <div style={{ background: hasResults ? 'linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)' : 'white', borderRadius: '16px', padding: '28px', boxShadow: '0 2px 12px rgba(0,0,0,0.08)', display: 'flex', flexDirection: 'column', gap: '16px', border: '2px dashed #cbd5e1', minHeight: hasResults ? 'auto' : '300px', justifyContent: 'center', alignItems: hasResults ? 'flex-start' : 'center', textAlign: hasResults ? 'left' : 'center' }}>
                    <div style={{ fontSize: '36px' }}>{hasResults ? 'üí¨' : 'üîç'}</div>
                    <div>
                        <div style={{ fontSize: '18px', fontWeight: '600', color: '#1a365d', marginBottom: '8px' }}>{hasResults ? 'Besoin d\'un autre profil ?' : 'Aucun profil ne correspond'}</div>
                        <div style={{ fontSize: '14px', color: '#64748b', lineHeight: '1.5' }}>{hasResults ? 'D√©crivez-nous votre besoin, nous reviendrons vers vous avec des profils adapt√©s.' : hasActiveFilters ? 'Vos crit√®res sont tr√®s sp√©cifiques. Faites-nous une demande personnalis√©e !' : 'D√©crivez votre besoin id√©al et nous chercherons pour vous.'}</div>
                    </div>
                    {hasActiveFilters && !hasResults && (
                        <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap' }}>
                            {filters.secteur && <span style={{ background: '#e0f2fe', color: '#0369a1', padding: '4px 10px', borderRadius: '4px', fontSize: '12px' }}>{secteurIcons[filters.secteur]} {filters.secteur}</span>}
                            {filters.competence && <span style={{ background: '#ede9fe', color: '#6d28d9', padding: '4px 10px', borderRadius: '4px', fontSize: '12px' }}>{filters.competence}</span>}
                            {filters.seniorite && <span style={{ background: '#fef3c7', color: '#92400e', padding: '4px 10px', borderRadius: '4px', fontSize: '12px' }}>{filters.seniorite}</span>}
                        </div>
                    )}
                    <button onClick={onRequest} style={{ background: hasResults ? 'white' : 'linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)', color: hasResults ? '#1a365d' : 'white', border: hasResults ? '2px solid #1a365d' : 'none', padding: '12px 24px', borderRadius: '10px', fontSize: '14px', fontWeight: '600', cursor: 'pointer', marginTop: '8px' }}>Faire une demande personnalis√©e ‚Üí</button>
                </div>
            );
        };
        
        const App = () => {
            const [filters, setFilters] = useState({ competence: '', seniorite: '', secteur: '' });
            const [selectedReservation, setSelectedReservation] = useState(null);
            const [showConfirmation, setShowConfirmation] = useState(false);
            const [view, setView] = useState('timeline');
            const [showRequestModal, setShowRequestModal] = useState(false);
            
            const filteredConsultants = consultantsData.filter(c => {
                if (filters.competence && !c.competences.includes(filters.competence)) return false;
                if (filters.seniorite && c.seniorite !== filters.seniorite) return false;
                if (filters.secteur && !c.secteurs.includes(filters.secteur)) return false;
                return true;
            });
            
            const handleReserver = (consultant, periode) => {
                setSelectedReservation({ consultant, periode });
            };
            
            const handleSubmitReservation = (data) => {
                console.log('R√©servation envoy√©e:', data);
                setSelectedReservation(null);
                setShowConfirmation(true);
            };
            
            return (
                <div style={{ minHeight: '100vh', background: '#f5f7fa' }}>
                    <Header client="Airbus Defence & Space" />
                    <main style={{ padding: '32px', maxWidth: '1800px', margin: '0 auto' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '24px' }}>
                            <div>
                                <h1 style={{ fontSize: '28px', color: '#1a365d', marginBottom: '8px' }}>Plan de charge partag√©</h1>
                                <p style={{ color: '#64748b' }}>Visualisez les disponibilit√©s et r√©servez directement les cr√©neaux qui vous int√©ressent.</p>
                            </div>
                            <ViewToggle view={view} setView={setView} />
                        </div>
                        <Filtres filters={filters} setFilters={setFilters} consultantCount={filteredConsultants.length} totalCount={consultantsData.length} />
                        
                        {view === 'timeline' ? (
                            <>
                                <TimelineBooking consultants={filteredConsultants} onReserver={handleReserver} />
                                <div style={{ marginTop: '20px' }}>
                                    <RequestCard onRequest={() => setShowRequestModal(true)} hasResults={filteredConsultants.length > 0} filters={filters} />
                                </div>
                            </>
                        ) : (
                            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(340px, 1fr))', gap: '20px' }}>
                                {filteredConsultants.map(c => <ConsultantCard key={c.id} consultant={c} onInteret={handleReserver} />)}
                                <RequestCard onRequest={() => setShowRequestModal(true)} hasResults={filteredConsultants.length > 0} filters={filters} />
                            </div>
                        )}
                    </main>
                    <footer style={{ textAlign: 'center', padding: '24px', color: '#94a3b8', fontSize: '13px', borderTop: '1px solid #e2e8f0', marginTop: '40px' }}>Portail Partenaires Centum T&S ‚Ä¢ Propuls√© par SalesAiFlo</footer>
                    
                    {selectedReservation && <ModalReservation consultant={selectedReservation.consultant} periode={selectedReservation.periode} onClose={() => setSelectedReservation(null)} onSubmit={handleSubmitReservation} />}
                    {showConfirmation && <ModalConfirmation onClose={() => setShowConfirmation(false)} />}
                </div>
            );
        };
        
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
